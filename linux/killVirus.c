#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>

int my_system(const char * cmd) 
{
	FILE * fp;
	int res; char buf[1024];
	if (cmd == NULL){
		printf("my_system cmd is NULL!\n");
		return -1;
	}
	if((fp = popen(cmd, "r")) == NULL){
		perror("popen");
		printf("popen error: %s/n", strerror(errno));
		return -1;
	}else{
		while(fgets(buf, sizeof(buf), fp)){
			//printf("%s", buf);
			} 
		if((res = pclose(fp)) == -1){
			printf("close popen file pointer fp error!\n");
			return res;
			}else if(res == 0){
				return res;
			} else{
				printf("popen res is :%d\n", res); return res;
			}
	}
}
int killProcessByPid(int pid){
	 int result;
	 char temp_link[20];
	 sprintf(temp_link,"kill -9 '%d'",pid);
	 result = my_system(temp_link);
	 return result;
}
int killProcessBySize(long file_size){
	 int result;
	 char temp_link[100];
	 sprintf(temp_link,"find / -size %dc | awk -F/ '{print $NF}' | xargs killall -9",file_size);
	 result = my_system(temp_link);
	 return result;
}
int killProcessByName(){
	 int result1,result2;
	 char *temp_link1="find /proc/ -name exe | xargs ls -l | grep -v task | grep '/bin/[a-z]\{10\}\($\| \)' | awk '{print $11}' | awk -F/ '{print $NF}' | xargs killall -9";
	 char *temp_link2="ls -l /tmp/ | awk '{print $9}' | grep '^[0-9\.]\+$' | xargs killall -9";
	 result1 = my_system(temp_link1);
	 result2 = my_system(temp_link2);
	 return result2;
}